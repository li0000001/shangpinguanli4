# 商品保质期管家 - 功能详解

## ✨ 已实现功能

### 1. 商品管理

#### 添加商品
- **方式一**: 生产日期 + 保质期天数
  - 用户选择生产日期
  - 输入保质期天数
  - 系统自动计算到期日
  - 实时预览计算结果

- **方式二**: 直接选择保质日期
  - 用户直接选择到期日期
  - 无需计算，简单直观

#### 自定义提醒
- 可设置提前提醒天数（默认3天）
- 支持任意天数设置
- 提醒信息自动同步到手机日历

#### 查看商品列表
- **智能排序**: 按到期日期从近到远排序
- **颜色标识系统**:
  ```
  🔴 红色卡片 - 已过期商品
  🟠 橙色卡片 - 今天到期
  🟡 黄色卡片 - 提醒期内（临近到期）
  🟢 白色卡片 - 安全期（距离到期时间较长）
  ```
- **信息展示**:
  - 商品名称（粗体显示）
  - 到期日期（格式：yyyy年MM月dd日）
  - 剩余天数（动态计算）
  - 提醒设置（提前X天提醒）

#### 删除商品
- 点击删除按钮
- 弹出确认对话框
- 删除后自动清理：
  - 数据库记录
  - 日历提醒事件

### 2. 日历集成

#### 自动日历同步
- 保存商品时自动创建日历事件
- 事件标题：⏰ [商品名] 即将过期
- 事件描述：商品【商品名】将在今天到期，请及时查看
- 设置提醒：根据用户设置的提前天数

#### 日历事件管理
- 存储日历事件ID
- 删除商品时同步删除事件
- 支持所有系统日历（Google、本地等）

### 3. 权限管理

#### Android 13+ 适配
- **日历权限** (READ_CALENDAR, WRITE_CALENDAR)
  - 首次启动自动请求
  - 提供明确的权限说明
  - 支持后续重新授权

- **通知权限** (POST_NOTIFICATIONS)
  - Android 13+ 专属
  - 运行时动态请求
  - 优雅降级处理

#### 权限状态检查
- 实时检查权限状态
- 无权限时友好提示
- 引导用户授予权限

### 4. 用户界面

#### Material Design 3
- 现代化设计语言
- 流畅的动画效果
- 符合 Android 设计规范

#### 主界面 (MainActivity)
- **顶部工具栏**: 显示应用名称
- **商品列表**: RecyclerView 展示所有商品
- **空状态提示**: 无商品时显示友好提示
- **悬浮按钮**: 右下角 + 按钮添加商品

#### 添加界面 (AddProductActivity)
- **清晰的分区设计**:
  - 商品名称输入区
  - 方式一卡片（生产日期+天数）
  - 分隔符（"或"）
  - 方式二卡片（直接选择）
  - 提醒设置区
  - 保存按钮

- **日期选择器**: Material DatePicker
- **实时反馈**: 输入时即时计算预览
- **输入验证**: 保存前检查必填字段

#### 深色模式支持
- 自动跟随系统设置
- 独立的深色主题配置
- 所有组件适配深色模式

#### 响应式设计
- 支持不同屏幕尺寸
- 适配横屏/竖屏
- 滚动视图支持长内容

### 5. 数据持久化

#### Room 数据库
- **表结构**: products 表
  - id (主键，自增)
  - name (商品名称)
  - productionDate (生产日期，可选)
  - shelfLifeDays (保质期天数，可选)
  - expiryDate (到期日期，必需)
  - reminderDays (提前提醒天数)
  - calendarEventId (日历事件ID)
  - createdAt (创建时间)

- **数据访问**: DAO 模式
- **异步操作**: 使用 Coroutines
- **实时更新**: LiveData 观察者模式

#### 数据安全
- 本地存储，隐私安全
- 自动备份支持
- 数据完整性保证

### 6. 架构设计

#### MVVM 架构
```
View (Activity/Fragment)
    ↓ 用户交互
ViewModel
    ↓ 业务逻辑
Repository
    ↓ 数据操作
Data Source (Room/Calendar)
    ↓ LiveData
View (自动更新)
```

#### 关键特性
- **单一职责**: 每个类职责明确
- **可测试性**: 层次分离，易于测试
- **可维护性**: 代码结构清晰
- **可扩展性**: 易于添加新功能

### 7. 性能优化

#### UI 优化
- ViewBinding 减少 findViewById
- RecyclerView 视图复用
- DiffUtil 智能刷新

#### 数据库优化
- 索引优化（按到期日期排序）
- 异步查询（避免阻塞 UI）
- LiveData 自动更新

#### 内存优化
- 及时释放资源
- 避免内存泄漏
- 使用 ViewModel 保存状态

## 🎯 使用场景

### 日常生活
- 食品保质期管理（牛奶、面包等）
- 药品过期提醒
- 化妆品保质期跟踪
- 调味品到期提醒

### 商业用途
- 便利店商品管理
- 餐厅食材跟踪
- 药店药品管理
- 超市库存监控

### 特殊场景
- 节日礼品管理
- 团购商品跟踪
- 冰箱食材管理
- 储藏室物品监控

## 📱 用户体验亮点

1. **零学习成本**: 界面直观，无需说明书
2. **快速添加**: 两种方式，灵活选择
3. **智能提醒**: 日历集成，不会错过
4. **视觉明确**: 颜色标识，一目了然
5. **简洁高效**: Material Design，赏心悦目

## 🔒 隐私保护

- ✅ 所有数据本地存储
- ✅ 不上传任何信息
- ✅ 不需要网络权限
- ✅ 不收集用户数据
- ✅ 完全离线运行

## 🌍 本地化

- ✅ 简体中文界面
- ✅ 中国日期格式 (yyyy年MM月dd日)
- ✅ 本地时区支持
- ✅ 中文排序支持

## 📊 数据统计

截至当前版本：
- 9 个 Kotlin 源文件
- 14 个 XML 资源文件
- 10 个应用图标文件
- ~1500+ 行代码
- 100% Kotlin 编写
- 0 警告，0 错误
